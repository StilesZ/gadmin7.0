{include file='common/head' /}
{$config.load_file.css|raw}
{$config.g_js|raw}
<link rel="stylesheet" type="text/css" href="/static/list/css.css?v=1.0.0">
<style>.layui-table-tool{background-color:#FFFFFF}.layui-table-tool-temp{padding-right: 0px;}</style>
</head>
<body>
<div class="layui-fluid">
    <div class="layui-card">
        <div class="layui-card-body">
            <div class="layui-row">
                <div class="layui-col-md2">
                  　
                </div>
                <div class="layui-col-md10 align-right">
                    <form id='searchform' method="post" action="" class="layui-form" >
                        <div class="layui-inline" id='search'>

                        </div>
                        <div class="layui-inline">
                            <div class="layui-btn-group">
                                <a class="layui-btn layui-btn-sm layui-btn-primary" id='searchsubmit'  lay-submit lay-filter="search"><i class="layui-icon layui-icon-search" ></i></a>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div style="height:10px;"></div>
            <table id="tabledata" class="layui-table"  lay-filter='tabledata_filter'>
                <thead>
                <tr>
                    <th lay-data="{width:40,fixed:'left',type:'radio',event:'checked'}"></th>
                    <th lay-data="{field:'id',hide:true}"></th>
                    <th lay-data="{width:40,type:'numbers'}">ID</th>
                    {volist name='config.field' id='k'}
                    {in name="config['sql_field'][$key]" value='$count_field'}
                    <th lay-data="{field:'{$config['sql_field'][$key]}',sort: true,totalRow:true}"> {$k} </th>
                    {else/}
                    <th lay-data="{field:'{$config['sql_field'][$key]}',sort: true,width:{$config['field_lenth'][$config['sql_field'][$key]]}}"> {$k}</th>
                    {/in}
                    {/volist}
                    {eq name='gbtn' value='1'}
                    <th lay-data="{field:'status'}">状态</th>
                    <th lay-data="{field:'url',fixed:'right',width:185}">操作</th>
                    {else/}
                    <th lay-data="{field:'url',fixed:'right'}">操作</th>
                    {/eq}
                </tr>
                </thead>
            </table>
        </div>
    </div>
</div>
</body>

<script>
    var g_list_limit = 16;
    var g_list_limit_page = [16,30,50,100,200];
</script>
{include file='common/footer' /}
<script>
    var Server_Url = '/gadmin/wf/wfdo';
    var System_Url = '/gadmin/sfdp/';
</script>
<script src="__SFDP__/sfdp.plug.js?v=7.0.1"></script>
<script src="__SFDP__/sfdp.7.0.js?v=7.0.1"></script>
<script src="__SFDP__/sfdp.config.js?v=7.0.1"></script>
<script type="text/javascript" src="__FLOW__/workflow.5.0.js"></script>
<script type="text/javascript" src="__SFDP__/lib/laydate5.0.9/laydate.js"></script>
{$config.fun|raw}
<script>
    window.onresize = function (){
        adjustButtons()
    }
    $(document).ready(function() {
        adjustButtons();
        sfdp.generateFilterGroup({$config['search']|raw});/*渲染查询数据*/
        layui.use(['form','table'],function (){
            let form = layui.form;
            let table = layui.table;
            form.render();
            $('.layui-input').keypress(function(e){
                if(e.keyCode==13){
                    e.preventDefault();
                }
            });
            //监听提交  搜索事件
            form.on('submit(search)', function(data){
                var param = {};
                var search = $('#searchform').serializeArray();
                var searchdata = sfdp.list_to_json(search);
                if(searchdata != {}){
                    param.search = searchdata;
                }
                table.reload('tabledata',{
                    page: {curr: 1},
                    where:param
                })
                return false;
            });
        })
        try{
            load_list_fun();//后置函数
        }catch(e){
            g_log('page no load end fun ~');
        }
        initLaytable();
    });
    document.onkeydown = function (event) {
        var e = event || window.event;
        if (e && e.keyCode == 13) { //回车键的键值为13
            $('#searchsubmit').trigger("click");
        }
    };
    var TableData;
    var TableObj;
    function initLaytable(){
        var ymheight = 84;
        var typesss = '{$config.sfdp_design.s_type}';
        if(typesss==2){
            var ymheight = 185;
        }
        var toolbar = false;
        if('{$count_field}' != ''){
            toolbar = true;
        }
        var table = layui.table;
        var form = layui.form;
        TableObj = table.init('tabledata_filter', {
            limit: g_list_limit,
            limits:g_list_limit_page,
            url:window.location.href,
            page:true,
            cellMinWidth: 120,
            skin:'nob',// 无边框风格
            size:'lg',// 大尺寸
            escape:false,
            height:'full-'+ymheight,
            method: 'post',id:'tabledata',
            totalRow: toolbar,
            done:function(res, curr, count){
                TableData = res.data;
                $(".layui-table-box").css("border-width","0px");
                $(".layui-table-header tr").css("height","40px");
                $(".layui-table-header tr").css("background-color","white");
                $(".layui-table-header tr span").css("color","#666666");
                $(".layui-table-body tr").css("height","40px");
                setTimeout(()=>{
                    TableObj.resize();
                },0)
            }
        });
        //更改Gadmin 选中表单选中状态
        table.on('tool(tabledata_filter)',function(obj){
            if(obj.event == 'checked'){
                $('input:checkbox').prop('checked',false);
                $("input[name='ids']").prop('checked',false);
                $(obj.tr).find('input:checkbox').prop('checked',true);
                localStorage.setItem("suphelpselect", SON.stringify(obj.data))
            }
        });
    }
    $('body').on("mouseenter",".layui-table-body tr",function () {
        $(this).siblings().find("div").css("color","#666");
        $(this).find("div").css("color","#4DA1FF");
    })
</script>
<script type="text/javascript" src="/static/list/js.js?v1.0"></script>